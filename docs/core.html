

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Core Objects &mdash; dvt 0.0.9 documentation</title>
  

  
  
  
  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Abstract Classes" href="abstract.html" />
    <link rel="prev" title="Command Line Interface" href="cli.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #268bd2" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> dvt
          

          
          </a>

          
            
            
              <div class="version">
                0.0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html"> Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html"> Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo.html"> Minimal Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/index.html"> Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="dvt.html"> API Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="dvt.html#core-functions">Core Functions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Core Objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="abstract.html">Abstract Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html">Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dvt.html#annotations">Annotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvt.html#aggregators">Aggregators</a></li>
<li class="toctree-l2"><a class="reference internal" href="dvt.html#pipelines">Pipelines</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">dvt</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="dvt.html">Distant Viewing Toolkit (DVT): API Docs</a> &raquo;</li>
        
      <li>Core Objects</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/core.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-dvt.core">
<span id="core-objects"></span><h1>Core Objects<a class="headerlink" href="#module-dvt.core" title="Permalink to this headline">¶</a></h1>
<p>Core objects for working with the distant viewing toolkit.</p>
<p>The objects VisualInput, FrameAnnotator, and Aggregator are abstract classes.
They correspond to the method for extracting visual inputs from digitized
files, methods for extracting metadata from visual images, and methods for
aggregating the data across a collection. The toolkit provides many ready-made
implementions of these classes in order to solve common tasks.</p>
<p>A DataExtraction class is constructed for each input object. Annotators and
aggregators can be iteratively passed to the object to extract metadata. The
FrameBatch object serves as the primary internal structure for storing visual
information. Users who construct their own FrameAnnotator subclasses will need
to interface with these objects and their methods for grabbing visual data
inputs. See the example in DataExtraction for the basic usage of the classes.</p>
<dl class="class">
<dt id="dvt.core.DataExtraction">
<em class="property">class </em><code class="descclassname">dvt.core.</code><code class="descname">DataExtraction</code><span class="sig-paren">(</span><em>vinput</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dvt/core.html#DataExtraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dvt.core.DataExtraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The core class of the toolkit. Used to pass algorithms to visual data.</p>
<p>Each instance of a data extraction is tied to a particular input object.
Collections of annotators or individual aggregators can be passed to the
relevant methods to extract metadata from the associated input.</p>
<dl class="attribute">
<dt id="dvt.core.DataExtraction.vinput">
<code class="descname">vinput</code><a class="headerlink" href="#dvt.core.DataExtraction.vinput" title="Permalink to this definition">¶</a></dt>
<dd><p>The input object associated with the dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="abstract.html#dvt.abstract.VisualInput" title="dvt.abstract.VisualInput">VisualInput</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="dvt.core.DataExtraction.data">
<code class="descname">data</code><a class="headerlink" href="#dvt.core.DataExtraction.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Each key in the ordered dictionary is associated
with an aggregator and annotator and contains a pandas DataFrame
with all of the extracted metadata.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">OrderedDict</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Example</p>
<p>Assuming we have an input named “input.mp4”, the following example
shows a straightforward usage of DataExtraction. We create an
extraction object, pass through a difference annotator, and then
aggregate use the cut detector. Finally, the output from the cut
aggregator is obtained by calling the get_data method and grabbing
the relevant key (“cut”).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dvt.core</span> <span class="k">import</span> <span class="n">DataExtraction</span><span class="p">,</span> <span class="n">FrameInput</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dvt.annotate.diff</span> <span class="k">import</span> <span class="n">DiffAnnotator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dvt.aggregate.cut</span> <span class="k">import</span> <span class="n">CutAggregator</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dextra</span> <span class="o">=</span> <span class="n">DataExtraction</span><span class="p">(</span><span class="n">FrameInput</span><span class="p">(</span><span class="n">input_path</span><span class="o">=</span><span class="s2">&quot;input.mp4&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dextra</span><span class="o">.</span><span class="n">run_annotators</span><span class="p">([</span><span class="n">DiffAnnotator</span><span class="p">(</span><span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">])])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dextra</span><span class="o">.</span><span class="n">run_aggregator</span><span class="p">(</span><span class="n">CutAggregator</span><span class="p">(</span><span class="n">cut_vals</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;q40&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dextra</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;cut&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Using the input file in the Distant Viewing Toolkit test directory
yields the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dextra</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;cut&#39;</span><span class="p">]</span>
<span class="go">   frame_start  frame_end</span>
<span class="go">0            0         74</span>
<span class="go">1           75        154</span>
<span class="go">2          155        299</span>
<span class="go">3          300        511</span>
</pre></div>
</div>
<dl class="method">
<dt id="dvt.core.DataExtraction.get_data">
<code class="descname">get_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dvt/core.html#DataExtraction.get_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dvt.core.DataExtraction.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get dataset from the object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">An ordered dictionary where each key corresponds to an annotator
or aggregator and the values are all pandas DataFrame objects.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dvt.core.DataExtraction.get_json">
<code class="descname">get_json</code><span class="sig-paren">(</span><em>path=None</em>, <em>exclude_set=None</em>, <em>exclude_key=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dvt/core.html#DataExtraction.get_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dvt.core.DataExtraction.get_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Get dataset as a JSON object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path_or_buf</strong> – Location to store the output. If set to None, return
as a string.</li>
<li><strong>exclude_set</strong> – Set of dataset names to ignore when creating the
output. None, the default, includes all data in the output.</li>
<li><strong>exclude_key</strong> – Set of column names to ignore when creating the
output. None, the default, includes all keys in the output.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dvt.core.DataExtraction.run_aggregator">
<code class="descname">run_aggregator</code><span class="sig-paren">(</span><em>aggregator</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dvt/core.html#DataExtraction.run_aggregator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dvt.core.DataExtraction.run_aggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an aggregator over the extracted annotations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>aggregator</strong> (<a class="reference internal" href="abstract.html#dvt.abstract.Aggregator" title="dvt.abstract.Aggregator"><em>Aggregator</em></a>) – Aggregator object use for processing the
input data.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dvt.core.DataExtraction.run_annotators">
<code class="descname">run_annotators</code><span class="sig-paren">(</span><em>annotators</em>, <em>max_batch=None</em>, <em>msg='Progress: '</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dvt/core.html#DataExtraction.run_annotators"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dvt.core.DataExtraction.run_annotators" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a collection of annotators over the input material.</p>
<p>Batches of inputs are grabbed from vinput and passed to the annotators.
Output is collapsed into one DataFrame per annotator, and stored as
keys in the data attribute. An additional key is included (“meta”)
that contains metadata about the collection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>annotators</strong> (<em>list</em>) – A list of annotator objects.</li>
<li><strong>max_batch</strong> (<em>int</em>) – The maximum number of batches to process. Useful
for testing and debugging. Set to None (default) to process
all available frames.</li>
<li><strong>progress</strong> (<em>bool</em>) – Should a progress bar be shown over each batch?</li>
<li><strong>msg</strong> (<em>str</em>) – Message to display in the progress bar, if used. Set
to None to supress the message</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="dvt.core.FrameBatch">
<em class="property">class </em><code class="descclassname">dvt.core.</code><code class="descname">FrameBatch</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dvt/core.html#FrameBatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dvt.core.FrameBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A collection of frames and associated metadata.</p>
<p>The batch contains an array of size (bsize * 2, width, height, 3). At the
start and end of the video file, the array is padded with zeros (an all
black frame). The batch includes twice as many frames as given in the
batch size, but an annotator should only return results from the first
half of the data (the “batch”). The other data is included for annotators
that need to look ahead of the current, such as the cut detectors.</p>
<dl class="attribute">
<dt id="dvt.core.FrameBatch.img">
<code class="descname">img</code><a class="headerlink" href="#dvt.core.FrameBatch.img" title="Permalink to this definition">¶</a></dt>
<dd><p>A four-dimensional array containing pixels from the
next 2*bsize of images.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">np.array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="dvt.core.FrameBatch.start">
<code class="descname">start</code><a class="headerlink" href="#dvt.core.FrameBatch.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Time code at the start of the current batch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="dvt.core.FrameBatch.end">
<code class="descname">end</code><a class="headerlink" href="#dvt.core.FrameBatch.end" title="Permalink to this definition">¶</a></dt>
<dd><p>Time code at the end of the current batch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="dvt.core.FrameBatch.continue_read">
<code class="descname">continue_read</code><a class="headerlink" href="#dvt.core.FrameBatch.continue_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether there more frames to read from
the input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="dvt.core.FrameBatch.fnames">
<code class="descname">fnames</code><a class="headerlink" href="#dvt.core.FrameBatch.fnames" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of frames in the batch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="dvt.core.FrameBatch.bnum">
<code class="descname">bnum</code><a class="headerlink" href="#dvt.core.FrameBatch.bnum" title="Permalink to this definition">¶</a></dt>
<dd><p>The batch number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="dvt.core.FrameBatch.bsize">
<code class="descname">bsize</code><a class="headerlink" href="#dvt.core.FrameBatch.bsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of frames in a batch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dvt.core.FrameBatch.get_batch">
<code class="descname">get_batch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dvt/core.html#FrameBatch.get_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dvt.core.FrameBatch.get_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return image data for just the current batch.</p>
<p>Use this method unless you have a specific need to look ahead at new
values in the data. Images are given in RGB space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A four-dimensional array containing pixels from the current batch
of images.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dvt.core.FrameBatch.get_frame_names">
<code class="descname">get_frame_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dvt/core.html#FrameBatch.get_frame_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dvt.core.FrameBatch.get_frame_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Return frame names for the current batch of data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A list of names of length equal to the batch size.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dvt.core.FrameBatch.get_frames">
<code class="descname">get_frames</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dvt/core.html#FrameBatch.get_frames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dvt.core.FrameBatch.get_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the entire image dataset for the batch.</p>
<p>Use this method if you need to look ahead at the following batch for
an annotator to work. Images are given in RGB space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A four-dimensional array containing pixels from the current and
next batches of data.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="abstract.html" class="btn btn-neutral float-right" title="Abstract Classes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cli.html" class="btn btn-neutral float-left" title="Command Line Interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Taylor Arnold and Lauren Tilton

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>